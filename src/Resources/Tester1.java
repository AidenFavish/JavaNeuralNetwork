// Useless class for now, was using it to test alignment to numpy & python programs
public class Tester1
{
    public static void main(String[] args) {
        final Matrix2D X = new Matrix2D(new float[][]{{0.0f, 0.0f},
                {0.0029955566779434318f, 0.00964660796601254f},
                {0.012880969253666478f, 0.015562848432370317f},
                {0.029974791069835673f, 0.004448094633219071f},
                {0.03931246097160195f, 0.009328284586546597f},
                {0.000828829717601726f, 0.05049824915595513f},
                {0.053483515095556426f, 0.028506283433812972f},
                {0.04173619504215374f, 0.057075212407646805f},
                {0.05546339331163955f, 0.058768681508467556f},
                {0.08160383482068392f, 0.04006590760828825f},
                {0.08918751038222271f, 0.04741970579718655f},
                {0.10716083565937823f, -0.02936382660910209f},
                {0.12118320422121277f, -0.0026475164629903795f},
                {0.12877772714642408f, 0.025679475194419755f},
                {0.14111296215622307f, -0.009224494750128338f},
                {0.15057946925015958f, -0.016812631531071223f},
                {0.1134763646197875f, -0.11507779268050945f},
                {0.17155251163341098f, -0.007518165654801652f},
                {0.16718684724566543f, -0.07145914460531948f},
                {0.19132587447574204f, 0.01507932302884421f},
                {0.13677189049844388f, 0.14867956145269237f},
                {0.13560642194959294f, -0.16311439837672587f},
                {0.1040247538363882f, -0.19637099235544328f},
                {0.21563353772977845f, -0.08646537852374674f},
                {-0.09830332486857582f, -0.22159866794444208f},
                {0.2460314109135828f, -0.05689945524180636f},
                {0.12416624773797284f, -0.23142017358845585f},
                {0.13264193552981812f, -0.23829872477241626f},
                {-0.12380430435908939f, -0.2542918240717879f},
                {-0.14615526748963031f, -0.2538625778666287f},
                {0.010245292717821385f, -0.30285705957062226f},
                {-0.05569057382044536f, -0.3081392205657858f},
                {0.1117952845923512f, -0.30328361169881946f},
                {0.238806717968922f, -0.23255636427331522f},
                {-0.040702291013502624f, -0.3410138879231031f},
                {-0.16072104199601928f, -0.3148904458046977f},
                {-0.32569508169593714f, -0.16172235070562918f},
                {-0.34792603670323613f, -0.13648112511291718f},
                {-0.18507461302617753f, -0.3362726461085902f},
                {-0.2373548125916429f, -0.3144056918010918f},
                {-0.14781402601009344f, -0.37603146385883773f},
                {-0.11835025534548697f, -0.3968706690682852f},
                {-0.10401211282773971f, -0.4112944382218153f},
                {-0.3568939985816258f, 0.24754977829452357f},
                {-0.3850840805133163f, -0.22190339144038482f},
                {-0.4211059579051736f, -0.17111791976499754f},
                {-0.35766899889688114f, -0.2965960625776431f},
                {-0.4327418827283702f, 0.19524248439263855f},
                {-0.37977776733446333f, -0.3014081961366042f},
                {-0.49072571312585944f, 0.06452346106554468f},
                {-0.5020192157161779f, -0.05525142263764641f},
                {-0.41547296950886453f, 0.3045706735232202f},
                {-0.5041040149051216f, 0.147544425312147f},
                {-0.5346620831067403f, 0.027200454104483008f},
                {-0.4071617234648671f, 0.36296004201860005f},
                {-0.27288741053462834f, 0.48391573282994965f},
                {-0.3162872643905218f, 0.4689666476997494f},
                {-0.2105485506519582f, 0.5358788051981533f},
                {-0.3957984072761988f, 0.4319420139577143f},
                {-0.28830878747245f, 0.5215801789586052f},
                {-0.3213194784737641f, 0.5138708504788897f},
                {-0.18288019363011868f, 0.5883961012861193f},
                {-0.2594370251857597f, 0.5699976377285484f},
                {-0.4487568930193674f, 0.4511938925268765f},
                {0.1725409933495348f, 0.6230137596735855f},
                {0.05350375071005571f, 0.6543820062023771f},
                {-0.2788938625046135f, 0.6055267606817244f},
                {0.44415152570942557f, 0.5106308946073554f},
                {0.09030308502500878f, 0.6809067086140952f},
                {0.4556201042399455f, 0.5274249511602694f},
                {0.645984288907079f, 0.2874948404453291f},
                {0.5846171546125969f, 0.41540107660392567f},
                {0.7272241840474873f, 0.008402735934035545f},
                {0.3360085452393031f, 0.65636749317336f},
                {0.735656100734754f, 0.13239561761695579f},
                {0.6162975486893297f, 0.44056595413854494f},
                {0.6280736634485016f, 0.44141940704168f},
                {0.7263660184891275f, 0.2780839419836943f},
                {0.7811311413144978f, 0.10289375325090572f},
                {0.7885483963846431f, -0.12232409633055537f},
                {0.7574836880852607f, 0.2814481385145113f},
                {0.5826627280485372f, -0.5743915327947846f},
                {0.653484000115257f, -0.5089313364507675f},
                {0.814698576680243f, 0.19787291279607808f},
                {0.16507665191039658f, -0.8322717327306088f},
                {-0.09342217215870859f, -0.853488121951773f},
                {0.12854314202775013f, -0.8591237026567424f},
                {0.5839788812347316f, -0.6566862281000957f},
                {0.7802731935033931f, -0.4257900894691421f},
                {-0.0829009770976176f, -0.8951593525636256f},
                {0.46384947657198455f, -0.7818503335521649f},
                {-0.33954991890940345f, -0.8541777548475149f},
                {0.02574850680729106f, -0.9289361457231753f},
                {-0.414920440347294f, -0.8427941632166611f},
                {-0.23339488378753054f, -0.9203626933650788f},
                {-0.48052033604120564f, -0.8306170070036716f},
                {-0.26559624100756785f, -0.9326150598195033f},
                {-0.9346775227986411f, -0.2939081652339697f},
                {-0.506961330773642f, -0.8502295097814815f},
                {-0.7005848082402775f, -0.7135691462380739f},
                {-0.0f, -0.0f},
                {-2.376371211420332e-05f, -0.010100982147627759f},
                {-0.002859050723937267f, -0.01999868618686703f},
                {-0.029650840738357342f, -0.006253102354427074f},
                {-0.015462018791707853f, -0.037328440308378855f},
                {-0.04476767506868807f, 0.023379807429961177f},
                {-0.05014582573801044f, -0.034036608868078806f},
                {-0.055761180602246475f, -0.043476207123188074f},
                {-0.05778877547935812f, 0.05648365562250426f},
                {-0.07216310460489445f, 0.055289683881357264f},
                {-0.058894951044525676f, 0.08206354396157733f},
                {-0.09363084759685396f, 0.059824270916078774f},
                {-0.11844548508682216f, -0.025749667789883277f},
                {-0.03858067077143835f, 0.12551760951390667f},
                {-0.13572699374945024f, 0.039700661954625946f},
                {-0.0916938124834638f, 0.12061959165453472f},
                {-0.07414070895608556f, 0.1436068904023421f},
                {-0.1373127941969147f, 0.10311151057171257f},
                {-0.07763251703862191f, 0.1644112025925165f},
                {-0.03550571007136235f, 0.18860625858980393f},
                {-0.07077987172829085f, 0.18921514681021165f},
                {-0.1779022683382827f, 0.11552571814044665f},
                {-0.04306561878098878f, 0.218009331287432f},
                {0.09474382085921124f, 0.21212659589526317f},
                {-0.11396535782297637f, 0.213965909740895f},
                {-0.029211065425043075f, 0.25083005565457345f},
                {-0.04124075812331755f, 0.2593679889470802f},
                {0.2412416206551755f, 0.12721102842489965f},
                {0.15924361485018312f, 0.23373769207605713f},
                {0.15724777958300923f, 0.24714511217555737f},
                {0.023906760932298887f, 0.30208580128228996f},
                {0.2320321498531647f, 0.21026721260781245f},
                {0.10436996095789332f, 0.3059183649796346f},
                {0.2351075038701912f, 0.23629551992164213f},
                {0.17952332019661218f, 0.2927772630443888f},
                {0.3413239145501709f, 0.09211531661735228f},
                {0.35545637954164006f, 0.07669528800276582f},
                {0.32727642588185424f, 0.18047095497644094f},
                {0.38189079480755256f, 0.038617686995964635f},
                {0.2897659652311435f, 0.266878121042173f},
                {0.26896159908363954f, 0.3015100434736869f},
                {0.40380004402792824f, -0.09197083967265693f},
                {0.41672009307827457f, -0.0795361461973312f},
                {0.37611240716919536f, -0.2172410553524418f},
                {0.03194861460863698f, -0.4432946539516574f},
                {0.2894293673518595f, -0.35048853271146585f},
                {0.46399680994401477f, -0.02456211453104498f},
                {0.18574097346975527f, -0.4369044009318422f},
                {0.4841582879209106f, -0.025861274086249032f},
                {0.41358972680576256f, -0.2718796432826387f},
                {0.3220980813838847f, -0.3890100752173273f},
                {-0.1523475465981014f, -0.4921090413805066f},
                {0.38682500380689f, -0.35532609208156146f},
                {0.37177315836746977f, -0.3852117943846025f},
                {0.16257008324941477f, -0.5206646033573852f},
                {0.2585852413182557f, -0.4917068723142086f},
                {-0.2770881812048101f, -0.4931424643112688f},
                {0.27114586541638036f, -0.5079140731559254f},
                {0.24055339806183623f, -0.5341950442536189f},
                {-0.019497908685674692f, -0.5956405556820406f},
                {-0.06269163746291685f, -0.6028094365641329f},
                {-0.6090221569556175f, -0.09352619722848896f},
                {-0.5366921872396959f, -0.32274815756133013f},
                {-0.4096883282520274f, -0.48694368399231713f},
                {-0.09274740793375917f, -0.639776880990732f},
                {-0.6289767361580911f, -0.1883261180861719f},
                {-0.29512624369900675f, -0.5977833593573504f},
                {-0.1917896880309897f, -0.6490232691379364f},
                {-0.6752814077268595f, 0.12563285151243378f},
                {-0.6890817699235519f, -0.10456133536377793f},
                {-0.6846718622956584f, 0.17655997784907207f},
                {-0.7161903018105977f, 0.037506312848300756f},
                {-0.6633561178801444f, 0.2981346687416525f},
                {-0.7178659869395728f, -0.16848873364052155f},
                {-0.7092625185354072f, -0.23593468993187222f},
                {-0.6086443029297619f, 0.4510799718205491f},
                {-0.7676715221623465f, -0.0028379026755653886f},
                {-0.7685440530572449f, 0.11949188305186713f},
                {-0.7339145865692702f, 0.28656999844750897f},
                {-0.6052729334513159f, 0.5200158016975235f},
                {-0.6552993681697624f, 0.472839645614496f},
                {-0.799242430408625f, 0.17502292717761334f},
                {-0.6428717052798522f, 0.5222723563226148f},
                {-0.8383654521452131f, -0.005552397011251698f},
                {-0.04417904102511746f, 0.8473339072894801f},
                {-0.750967461964845f, 0.41619412253622134f},
                {-0.5694468051838976f, 0.656008545595901f},
                {-0.031273493017608046f, 0.8782312363717071f},
                {-0.288415399962145f, 0.8407972489576779f},
                {0.7107756133136205f, 0.5504369773230317f},
                {-0.35826177666335984f, 0.835520664241016f},
                {0.42110809365955415f, 0.8170567653242582f},
                {0.3820929308650226f, 0.8471070420063869f},
                {-0.03724967302737085f, 0.9386551204939002f},
                {0.747896860368288f, 0.5849708927525151f},
                {0.5888223088643725f, 0.7577022464375568f},
                {0.9149960238302937f, 0.3210833060348025f},
                {0.9581458196471903f, 0.2048430362712304f},
                {0.8385625381108968f, -0.5260350557520397f},
                {0.969426955837734f, -0.24538006702905632f},
                {0.0f, 0.0f},
                {0.009143067281213125f, 0.0042935679512403355f},
                {0.01910214033589073f, -0.00657494143173678f},
                {0.029635341268205825f, -0.006326151552353904f},
                {0.038554359662083426f, -0.012085025114497865f},
                {0.03784384067191872f, 0.033445535572272325f},
                {0.05969568319880478f, -0.010465179865316643f},
                {0.07046776355153049f, 0.00581241326991545f},
                {0.06981592863090244f, -0.040690072908389524f},
                {0.08226317773842241f, -0.03869408738158944f},
                {0.050711298067359f, -0.08735791180193288f},
                {0.07338420505651279f, -0.08342923624587105f},
                {0.045619294268191134f, -0.11229985894565563f},
                {0.10377100237656464f, -0.08046562943905111f},
                {0.1226117147311361f, -0.07045797898456423f},
                {0.09539201549007746f, -0.11771662804973707f},
                {0.06047125476834725f, -0.14987665275913695f},
                {0.014475898453666602f, -0.1711059187360384f},
                {-0.14859771242176897f, -0.10476913239445416f},
                {0.01783905424117511f, -0.19108831563100878f},
                {0.08767514071666997f, -0.18200338382732165f},
                {0.009103003397357652f, -0.21192579824296987f},
                {0.00016096448134141398f, -0.22222216392569502f},
                {-0.12592101094644811f, -0.19523827309044478f},
                {0.08022905156484336f, -0.22876366101278753f},
                {-0.13536272712146297f, -0.21318052272471547f},
                {-0.17185835015003148f, -0.19858817010272253f},
                {-0.20529278360577136f, -0.17954118827904128f},
                {-0.14504238559901006f, -0.24280556819674307f},
                {-0.21401078595218195f, -0.2000173846248992f},
                {-0.09736996208264902f, -0.28696072037590925f},
                {-0.24401472060319132f, -0.196234643710755f},
                {-0.26658292490640706f, -0.18279135354417075f},
                {-0.33326270151890897f, -0.006861697124600264f},
                {-0.2614093388831776f, -0.22273820012480708f},
                {-0.3303708360165004f, 0.12586642486829458f},
                {-0.24763848313816422f, 0.2662829071264373f},
                {-0.24396382419618703f, -0.2831276691029708f},
                {-0.3387511706975782f, 0.18049805887788026f},
                {-0.2972276173544505f, 0.2585420460566005f},
                {-0.39889639321814074f, 0.06426753126339481f},
                {-0.38447034079636316f, 0.15393397271225978f},
                {-0.3467449987312329f, 0.24443719107772122f},
                {-0.35029648084100107f, 0.25680069016196094f},
                {-0.3317827864066145f, 0.295721231638504f},
                {-0.4497420062222449f, 0.06590673779761909f},
                {0.04171047547643332f, 0.4627705407045572f},
                {0.07307710917406378f, 0.4690894380540519f},
                {-0.3089748963661917f, 0.3736476504347011f},
                {-0.392718215529755f, 0.30124310073740285f},
                {0.08957227300974197f, 0.49704408311500753f},
                {-0.13697017197236963f, 0.4966087550101803f},
                {0.09959090322618419f, 0.5157246041045042f},
                {0.03270573839615811f, 0.5343535744163138f},
                {0.33768125295359924f, 0.4283596999727124f},
                {0.3868171325409918f, 0.39876619876991426f},
                {0.09069214694118785f, 0.5583388619410068f},
                {-0.03845926708907655f, 0.5744716449201054f},
                {-0.038419127346681375f, 0.5845975139171748f},
                {0.5395118350844614f, 0.2531695475765634f},
                {0.19835815608687205f, 0.5726809758778139f},
                {0.4313436061975067f, 0.4399975347924408f},
                {0.46286849261099033f, 0.42185025257950426f},
                {0.5941728404020146f, 0.22785371055691123f},
                {0.23000933554778183f, 0.604162432371898f},
                {0.6559447985315336f, 0.028546149668868013f},
                {0.6498516369820274f, -0.148786069093258f},
                {0.6727990105427817f, -0.0731845593699419f},
                {0.686836331881677f, -0.006666798934804809f},
                {0.6627065966729065f, -0.21583958214434368f},
                {0.5965421911892561f, -0.3795871427335109f},
                {0.43555085449205305f, 0.5697637449524776f},
                {0.017198727801414886f, -0.7270693389194208f},
                {0.4781518445798316f, -0.5613295307512496f},
                {0.6746768683162067f, -0.32176019249042215f},
                {0.5906184556237833f, -0.47443742300018893f},
                {0.26373603385339606f, -0.7209514020223071f},
                {0.409585681323366f, -0.6611942538012656f},
                {0.7778269690378139f, -0.1254519454882861f},
                {-0.5367175756808783f, -0.5905133376471017f},
                {0.19897966526888194f, -0.7831996458107062f},
                {-0.3318063089590112f, -0.7478810473185579f},
                {0.27429245754873166f, -0.7815472419246828f},
                {-0.6449409697223006f, -0.5356665063608856f},
                {-0.29387986926587323f, -0.795965552363059f},
                {-0.4960320430624332f, -0.7008008909946708f},
                {0.0954422992731588f, -0.8634278448940883f},
                {-0.79065918470032f, -0.38357031891626453f},
                {-0.7278969732650172f, -0.5101857045250782f},
                {-0.8802923451179062f, -0.18239579384592744f},
                {-0.43785957988684093f, -0.7966964724994424f},
                {-0.5758860586063821f, -0.7164279669377309f},
                {-0.7671058081716557f, 0.524532198728681f},
                {-0.5223280252956258f, -0.7807908858079968f},
                {-0.8676859657879483f, -0.3855667567245033f},
                {-0.9111010581383445f, 0.30119639362396033f},
                {-0.964920242770055f, -0.09613083861105157f},
                {-0.9506984538747548f, 0.23701588768762608f},
                {-0.9793868320387701f, -0.14387996188525587f},
                {-0.9427887647158077f, 0.3333906794222676f},
        });
        final int[] y = new int[]{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};

        float[] regulars = new float[]{0, (float)(Math.pow(10, -4) * 5), 0, (float)(Math.pow(10, -4) * 5)};
        LayerDense dense1 = new LayerDense(2, 64, regulars);
        ActivationReLU activation1 = new ActivationReLU();
        LayerDense dense2 = new LayerDense(64, 3);
        ActivationSoftMaxCCE lossActivation = new ActivationSoftMaxCCE();
        AdamOptimizer optimizer = new AdamOptimizer(0.02f, (float)(5 * Math.pow(10, -7)), (float)(1 * Math.pow(10, -7)), 0.9f, 0.999f);
        float dataLoss;
        float regLoss;
        float loss;
        int[] predictions;
        int ctr;
        float accuracy;

        for (int epoch = 0; epoch < 10001; epoch++) {
            dense1.forward(X);
            activation1.forward(dense1.getOutput());
            dense2.forward(activation1.getOutput());

            dataLoss = lossActivation.forward(dense2.getOutput(), y);
            regLoss = lossActivation.loss.regularization_loss(dense1) + lossActivation.loss.regularization_loss(dense2);
            loss = dataLoss + regLoss;

            predictions = lossActivation.getOutput().argmax(1);
            ctr = 0;
            for (int i = 0; i < predictions.length; i++) {
                if (predictions[i] == y[i])
                    ctr++;
            }
            accuracy = (float) ctr / predictions.length;

            if (epoch % 100 == 0) {
                System.out.println("epoch: " + epoch + ", acc: " + accuracy + ", loss: " + loss + ", dataLoss: " + dataLoss + ", regLoss: " + regLoss + ", lr: " + optimizer.getCurrentLearningRate());
            }

            lossActivation.backward(lossActivation.getOutput(), y);
            dense2.backward(lossActivation.getDInputs());
            activation1.backward(dense2.getDInputs());
            dense1.backward(activation1.getDInputs());

            optimizer.preUpdateParams();
            optimizer.updateParams(dense1);
            optimizer.updateParams(dense2);
            optimizer.postUpdateParams();
        }

        final Matrix2D xTest = new Matrix2D(new float[][]{{0.0f, 0.0f},
                {-0.0026857240601395097f, 0.009737417077104989f},
                {0.006555502081894503f, 0.01910882028533183f},
                {-0.005593313865200961f, 0.029782351914375796f},
                {0.029126071314841424f, 0.028002829334445853f},
                {-0.03031067543459753f, 0.040398305425056985f},
                {0.055337411073069935f, 0.02471569375752112f},
                {0.009200365584939694f, 0.07010594212388957f},
                {0.07363992512080018f, 0.033273222748754896f},
                {0.03213321472122759f, 0.085040692151445f},
                {0.06294014440691142f, -0.07900366275121647f},
                {0.11045618613468064f, 0.012046159426409098f},
                {0.11751826386416427f, 0.02969572338055817f},
                {0.12771788999006298f, -0.030516864710285013f},
                {0.13369041433554232f, -0.04609590553064135f},
                {0.14776559168246892f, -0.03349882167165277f},
                {0.160124415197745f, 0.021907883355574278f},
                {0.17150924024667338f, -0.008447933034388837f},
                {0.16262861253053393f, -0.08130058810404071f},
                {0.1651278742474794f, -0.09780471038464482f},
                {0.14004231571211903f, -0.14560326862495368f},
                {0.20289326158234958f, -0.061884836884721184f},
                {0.16184156760167578f, -0.15228270763817847f},
                {0.1800707268998002f, -0.14679447397941164f},
                {0.1268047296422999f, -0.20661576381126173f},
                {0.07275451489349165f, -0.2418176662809301f},
                {0.13733264450824673f, -0.22385776415708752f},
                {0.25890333409581745f, -0.08572764363567756f},
                {0.16905838452821828f, -0.2267401600694157f},
                {-0.07979825599252496f, -0.2818506856415413f},
                {0.17406775351881845f, -0.2480479424215189f},
                {-0.2261557625264244f, -0.21657513786081733f},
                {0.10356904124973161f, -0.30619044478359625f},
                {-0.16293210892876975f, -0.2907993105066356f},
                {0.002270848041433358f, -0.3434268357297538f},
                {-0.07961246971045487f, -0.34445478784010153f},
                {0.11257201430957524f, -0.34577296966790577f},
                {-0.34447286738822475f, -0.14497609513793616f},
                {-0.3476869675537949f, -0.1626212701368086f},
                {-0.23904886466173508f, -0.31311960398747396f},
                {-0.0011587345056947361f, -0.40403874248824f},
                {-0.4131685855924432f, -0.028369539766980926f},
                {-0.3872051322955052f, -0.1733603762429853f},
                {-0.43380200055171014f, -0.021680481419546843f},
                {-0.39352157530976495f, -0.20657113535838426f},
                {-0.43649483083505264f, 0.12682205211323758f},
                {-0.4603213938861163f, 0.06324991256279583f},
                {-0.46380953499921096f, -0.10132067914754594f},
                {-0.4761298173690931f, 0.09153387499688578f},
                {-0.44684779989843193f, 0.2128427736069305f},
                {-0.16119541774046361f, 0.47863561291576256f},
                {-0.5074400421035308f, 0.08880139206605228f},
                {-0.5160398349810484f, 0.09794439237080946f},
                {-0.34872239605801225f, 0.40619711754650345f},
                {-0.06743812134930685f, 0.5412695825057058f},
                {-0.5321949925815085f, 0.1594066033130691f},
                {-0.2527547648049119f, 0.5060458271133103f},
                {-0.5399701204155583f, 0.19982255903838325f},
                {0.04733951241602724f, 0.5839428509609779f},
                {-0.1253292064656753f, 0.5826323283366699f},
                {-0.038676514401135474f, 0.6048252519962505f},
                {0.01676830442928016f, 0.6159334064632815f},
                {0.33457250597394833f, 0.5294016578172704f},
                {0.04534104529239758f, 0.6347463015234852f},
                {-0.2520539921327544f, 0.5953027164213194f},
                {-0.13639693343250067f, 0.6422416507294599f},
                {0.5849405624654179f, 0.31982648862638785f},
                {0.2734643451281956f, 0.6190571381230701f},
                {0.6672850438306768f, -0.16284736190864765f},
                {0.6958359652599646f, -0.03973748790203743f},
                {0.27169841432042807f, 0.6527855363388766f},
                {0.6716926709729987f, 0.25132494438910863f},
                {-0.21910763066445968f, 0.6934821310021747f},
                {0.7088140464443627f, 0.20323059841392555f},
                {0.6760648509406851f, 0.31883352307275775f},
                {0.7574690329617029f, -0.012715839356721726f},
                {0.4040749998934685f, 0.6527258337860878f},
                {0.7773981682257958f, 0.024297317632111157f},
                {0.7869907092649213f, 0.03739796679024559f},
                {0.7978221955665094f, 0.01585882231799577f},
                {0.8066391133904308f, 0.04824865943455552f},
                {0.2528793103788861f, -0.7781218040805725f},
                {0.7454432798712153f, -0.3610633741090978f},
                {0.7899375641739586f, -0.28086670356261745f},
                {0.6262687934001621f, -0.5724630438041056f},
                {0.19755921520841974f, -0.8355477443269471f},
                {0.8686504371497489f, 0.007955744374176277f},
                {0.33969756683446783f, -0.8104774512540383f},
                {0.6215232122401706f, -0.635478051105452f},
                {0.6839003168262052f, -0.5834922408489124f},
                {0.7202047292654384f, -0.5547534848339686f},
                {0.010061130994504378f, -0.9191368548539631f},
                {0.8690125524429227f, -0.3292453980399271f},
                {-0.4529353445334974f, -0.8229887891352995f},
                {-0.36027066127847013f, -0.8784905860271872f},
                {-0.04025308078670415f, -0.9587513208126859f},
                {-0.49907684101628f, -0.8314051478074312f},
                {-0.2894206253405141f, -0.9360768039235394f},
                {-0.7002728199078114f, -0.699655620931757f},
                {-0.9369960679915349f, -0.34933990405964643f},
                {-0.0f, -0.0f},
                {-0.004829225508806955f, -0.008871808499161617f},
                {0.003608736458039512f, -0.01987708835366108f},
                {-0.026614953735078946f, -0.014488543171277785f},
                {-0.02707091642301257f, -0.029994198855605364f},
                {-0.05017900356394752f, -0.005729548659977066f},
                {-0.05229432097736704f, 0.03063329195012513f},
                {0.007227963229298174f, -0.0703366646602653f},
                {-0.07957056114640762f, 0.014087999245142143f},
                {-0.08173408066738812f, -0.039799533506992855f},
                {-0.09899626865182043f, 0.020069362199317847f},
                {-0.09406079002779048f, 0.05914597866037547f},
                {-0.09158142506094064f, 0.07940542117859006f},
                {-0.11765743191669682f, -0.05830837992971098f},
                {-0.1368332226397294f, 0.03570194075852228f},
                {0.04140150614081065f, 0.1457489500062753f},
                {0.006609941741259221f, 0.16148093499146712f},
                {-0.13646031281722704f, 0.10423708595489989f},
                {-0.11374972737968099f, 0.14184093471462206f},
                {-0.1370978465989127f, 0.13430248205024595f},
                {-0.19517300432151954f, 0.05215036345410597f},
                {-0.04987537343341618f, 0.20617433340900984f},
                {-0.20038334107268832f, 0.09606889543410704f},
                {-0.044121235947618666f, 0.2280951573698336f},
                {0.05325404814075523f, 0.23650268427988294f},
                {0.06636315065947314f, 0.24364920561637513f},
                {-0.08271698066251715f, 0.2492598141119331f},
                {-0.058816782699877404f, 0.26630950295115574f},
                {-0.05388227575466593f, 0.27764822694750513f},
                {0.1283319075673876f, 0.2633220312776183f},
                {0.27043689776663443f, 0.13671594230738493f},
                {0.24242225947895704f, 0.19819855542475004f},
                {0.1573888817550949f, 0.282325830702835f},
                {0.3221213042140888f, 0.08572617151445407f},
                {0.25514865511889484f, 0.22988325741819007f},
                {0.3040745436973502f, 0.18034943325282649f},
                {0.27873568252082304f, 0.23353334718692453f},
                {0.35631967424515404f, 0.11276486276290458f},
                {0.34531190044415566f, -0.16760547819002827f},
                {0.3901163697671872f, 0.054749101700469094f},
                {0.38266091473315705f, 0.12968913768206067f},
                {0.39778095335709884f, -0.115253737698037f},
                {0.19433565135625552f, -0.37711442446428506f},
                {0.4340493544717142f, -0.015980514382755974f},
                {0.28463127457063125f, -0.34134425692228776f},
                {0.3087205477726505f, -0.3336213326975488f},
                {0.422141842356924f, -0.1941458267384605f},
                {0.23313858982127364f, -0.41355962413568875f},
                {0.42046568944761664f, -0.24142629777472852f},
                {0.23740708066783775f, -0.43429584455706566f},
                {0.40129281735860145f, -0.3066595626882788f},
                {-0.0003545730090259806f, -0.5151513931271885f},
                {0.25381653950464916f, -0.459855824751671f},
                {0.040888750152927054f, -0.5337897694096998f},
                {0.15145277149012318f, -0.5240064113777477f},
                {0.30876858451648653f, -0.4618483912761062f},
                {-0.4059938519181589f, -0.3938735107557206f},
                {-0.4736633201616209f, -0.3273222344658402f},
                {-0.4732543526307405f, -0.3453412809675101f},
                {-0.20827764405975524f, -0.558380034565387f},
                {-0.4373713034441058f, -0.41954237109278136f},
                {-0.06330715265281166f, -0.6129007600369643f},
                {-0.13714265647486493f, -0.6110620008054659f},
                {0.11907344175363592f, -0.6251241421948875f},
                {-0.4231167185680552f, -0.48876250019499407f},
                {-0.6099804103423838f, -0.24290401474662532f},
                {-0.5242943143746813f, -0.4117765369212133f},
                {-0.6401659628656858f, 0.21954960329221282f},
                {-0.6652271412537041f, -0.1710597659887875f},
                {-0.2954240080132507f, -0.6312617634416154f},
                {-0.7025636309908758f, 0.0797077738140157f},
                {-0.6534202346603598f, 0.2955964628466145f},
                {-0.727079983412543f, 0.01674268662810762f},
                {-0.68867523351208f, 0.26352694609014f},
                {-0.33080785655699046f, 0.6702869983466837f},
                {-0.6785102364943768f, 0.33696422278756544f},
                {-0.58444888920134f, 0.49774201705498994f},
                {-0.6684120841594263f, 0.3976978216618621f},
                {-0.3917325575257755f, 0.6835924134772585f},
                {-0.5424180493502889f, 0.5852814858876938f},
                {-0.5667609767871277f, 0.5760005100517125f},
                {-0.443028802008283f, 0.6878567933766531f},
                {-0.5381410704871525f, 0.6296480222180825f},
                {-0.08098805441103046f, 0.8344629383657097f},
                {0.2984099236889581f, 0.7942783237331273f},
                {-0.11393605635717109f, 0.8509925097351866f},
                {-0.470844576214549f, 0.7300152470177174f},
                {-0.8156144055747658f, 0.32717163282201134f},
                {-0.11305672559648307f, 0.8816697985002805f},
                {0.6459214165980083f, 0.6252746293157042f},
                {0.04733000011924485f, 0.9078580021569717f},
                {0.6142204649895328f, 0.683847208589584f},
                {0.20830955463854578f, 0.9056447857080193f},
                {0.01614131313171523f, 0.9392552535815002f},
                {-0.11169902501298974f, 0.942901896767402f},
                {0.8730694077298307f, 0.39821378047372163f},
                {0.9692295572684261f, 0.030104457423055998f},
                {0.9587011524448067f, 0.20222804335008088f},
                {0.9561362518770415f, 0.2563268968515851f},
                {0.6308178795304693f, 0.775930926606668f},
                {0.0f, 0.0f},
                {0.007906761594909769f, 0.006285978534959218f},
                {0.019402758108861873f, 0.005626241908399181f},
                {0.02984957634163126f, 0.005222684919799414f},
                {0.03549669922203597f, -0.019299503240022546f},
                {0.04847785361740886f, -0.014165374515584875f},
                {0.056842086680719606f, -0.0210255027042649f},
                {0.0692810759198379f, 0.01412877798552854f},
                {0.033091064972597437f, -0.07372195970580715f},
                {0.06287700987999643f, -0.06565778277149013f},
                {0.07876285730481947f, -0.06324122718015092f},
                {0.09735175267419514f, -0.05355665470889701f},
                {0.07809814793626157f, -0.09269874658088839f},
                {0.12972302927469376f, -0.02037336818144267f},
                {0.10732512105008295f, -0.09208299399717539f},
                {0.0022317549093568713f, -0.15149871421462258f},
                {0.019501083054954797f, -0.16043531860293428f},
                {-0.08114605079690547f, -0.15133441612075782f},
                {-0.011328447160810539f, -0.1814649209202543f},
                {0.07746033714842966f, -0.17559291670157778f},
                {-0.11084570607383461f, -0.16889461646031323f},
                {-0.04900054989857351f, -0.2063839982687846f},
                {-0.10254207759363793f, -0.19714927941071217f},
                {-0.18947993529932303f, -0.13443005019741291f},
                {-0.07206925231943162f, -0.23146389823271785f},
                {-0.05407118885141434f, -0.24666842055507884f},
                {-0.2153883137402484f, -0.150267854596953f},
                {-0.10534170989412527f, -0.25156170107120474f},
                {-0.2027699667575769f, -0.19717042919445688f},
                {-0.19483711265629655f, -0.21873744578332516f},
                {-0.30298286285271386f, 0.0053618441054248825f},
                {-0.3116931403580778f, 0.029976749607989257f},
                {-0.2905018576674759f, -0.14173145548504992f},
                {-0.2879035130458187f, -0.16799606628426528f},
                {0.07107873851863634f, -0.33599845413450624f},
                {-0.2479101063965943f, -0.25204726807842365f},
                {-0.34035313951765833f, 0.12802790859477126f},
                {-0.36683303312943766f, 0.07150629575894916f},
                {-0.2527458990309874f, 0.28887958638623196f},
                {-0.381370265125998f, 0.09871659928838221f},
                {-0.3056894493018647f, -0.26420183323106533f},
                {-0.26317565587960356f, 0.31976817393135115f},
                {-0.2267322815610019f, 0.35857231770624964f},
                {-0.4334112233986896f, 0.028441701589399626f},
                {0.3025688071970682f, 0.32555027431853634f},
                {-0.25644301626816707f, 0.37529794784306847f},
                {-0.06932587083665445f, 0.4594456015038101f},
                {0.07159844528160861f, 0.46931740582718723f},
                {0.2342707227695831f, 0.4244941480313817f},
                {-0.18807875318809664f, 0.45782243845182075f},
                {0.045706691830229455f, 0.5029780422381346f},
                {-0.43428905369011883f, 0.2770813985236882f},
                {-0.4728379279614565f, 0.22872365239579218f},
                {0.2093274003802856f, 0.4927326326371744f},
                {0.452705617169338f, 0.30426679960250946f},
                {-0.11483820291591737f, 0.5435569542004633f},
                {0.5557304183538442f, 0.10550380271176021f},
                {0.08075754387976991f, 0.5700657901933317f},
                {0.4843166031488115f, 0.3296478583862159f},
                {0.5357631477969726f, 0.2610089835216484f},
                {0.4955306080161779f, 0.3489396434022168f},
                {0.6158533862544144f, 0.019487017982901252f},
                {0.3900656876973902f, 0.4899526878531477f},
                {0.6292280735263835f, 0.09503004352428057f},
                {0.5277335376363187f, 0.37338164441026905f},
                {0.5911900565430213f, 0.2856094858826488f},
                {0.659795614518137f, -0.09546827487222428f},
                {0.5957435224518612f, -0.3210983397250247f},
                {0.6860888993604731f, -0.03272025634143022f},
                {0.6632357226755011f, -0.21420815731698226f},
                {0.6100294651299826f, -0.3575094914414122f},
                {0.026564519239707932f, -0.7166795645395457f},
                {0.3848994017144726f, -0.6170721760009535f},
                {0.12375517860697834f, -0.7269144958910012f},
                {0.524137872640651f, -0.5329146165908478f},
                {0.43607951333895195f, -0.6194801744305833f},
                {0.5738710505495598f, -0.5099015953807113f},
                {0.31851287801318373f, -0.70956875505105f},
                {-0.07708806978525957f, -0.7840984720595565f},
                {-0.05443123350805956f, -0.796121221173428f},
                {-0.6079305021570679f, -0.5323674454130223f},
                {0.5669109308075958f, -0.5899436279291193f},
                {0.36050415353106313f, -0.7457138854245997f},
                {-0.43705680074330633f, -0.7154500774947501f},
                {-0.17533473368571215f, -0.8301712288869789f},
                {0.4029198641406147f, -0.7581723152717492f},
                {-0.06658883613645597f, -0.866130938560094f},
                {-0.4277938265533114f, -0.7676331010758819f},
                {-0.28604681573839913f, -0.8416060099571806f},
                {-0.5842249525290527f, -0.6832745007157044f},
                {-0.6593641581206987f, -0.6258475756743953f},
                {-0.8825389511447423f, 0.2569801237840426f},
                {-0.925675659789767f, -0.08191410932564136f},
                {-0.6807646431198657f, -0.6473179080235199f},
                {-0.9386375592249829f, -0.1431788794780281f},
                {-0.9595541901689119f, -0.008953312357695253f},
                {-0.9396271007132695f, 0.23961036005286013f},
                {-0.9591376245657415f, -0.20014769136462573f},
                {-0.673039143855325f, -0.725891397553058f},
                {-0.8937289103705012f, -0.4486074394924327f},
        });

        final int[] yTest = new int[]{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2};

        dense1.forward(xTest);
        activation1.forward(dense1.getOutput());
        dense2.forward(activation1.getOutput());
        loss = lossActivation.forward(dense2.getOutput(), yTest);
        predictions = lossActivation.getOutput().argmax(1);
        ctr = 0;
        for (int i = 0; i < predictions.length; i++) {
            if (predictions[i] == y[i])
                ctr++;
        }
        accuracy = (float) ctr / predictions.length;
        System.out.println("validation, acc: " + accuracy + ", loss: " + loss);
    }

}

